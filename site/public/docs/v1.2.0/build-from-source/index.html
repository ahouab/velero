<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
  <link rel="icon" href="/favicon.ico" type="image/x-icon">
  
  
  <link rel="stylesheet" href="/styles.666a5dc1cd80e47092a71103358e46b56345de6f3044680f856f219cbc2fe91b.css" integrity="sha256-Zmpdwc2A5HCSpxEDNY5GtWNF3m8wRGgPhW8hnLwv6Rs=">

</head>



    
    <meta name="robots" content="noindex">




    <title>Velero Docs - </title>


<body id="docs">
<div class="container-fluid site-outer-container">
    <div class="site-container">
        <header class="site-header">
    <div class="site-header-content">
        <div class="logo">
            <a href="/" aria-label="Velero homepage"><img src="/img/Velero.svg" class="logo" alt="Homepage"/></a>
        </div>
        <ul class="nav-menu" id="header-nav">
            <li class="home"><a href="/" title="Velero">Home</a></li>
            <li class="docs"><a href="/docs/v1.4" title="Documentation">Documentation</a></li>
            <li class="plugins"><a href="/plugins" title="Plugins">Plugins</a></li>
            <li class="blog"><a href="/blog" title="Blog Posts">Blog</a></li>
            <li class="community"><a href="/community" title="Community">Community</a></li>
            <li class="resources"><a href="/resources" title="Resources">Resources</a></li>
        </ul>
        <div class="nav-mobile-link">
            <a href="javascript:void(0);" id="nav-mobile-toggle"></a>
        </div>
    </div>
</header>

        <div class="post-single-hero post-single-hero-short bg-color-med-blue">
            <div class="section">
                <div class="section-content">
                    <h1>Documentation</h1>
                </div>
            </div>
        </div>
        <div class="section section-card pt-4 pb-0">
            <div class="container container-max">
                <div class="row">
                    <div class="col-md-3 toc">
                        <div class="row">
    <div class="dropdown mb-2">
        
            <button class="btn btn-primary dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown"
                    aria-haspopup="true" aria-expanded="false">
                v1.2.0
            </button>
            <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                
                
                

                
                    
                    <a class="dropdown-item"
                       href="/docs/master/build-from-source/">master</a>
                
                    
                    <a class="dropdown-item"
                       href="/docs/v1.4/build-from-source/">v1.4</a>
                
                    
                    <a class="dropdown-item"
                       href="/docs/v1.3.2/build-from-source/">v1.3.2</a>
                
                    
                    <a class="dropdown-item"
                       href="/docs/v1.3.1/build-from-source/">v1.3.1</a>
                
                    
                    <a class="dropdown-item"
                       href="/docs/v1.3.0/build-from-source/">v1.3.0</a>
                
                    
                    <a class="dropdown-item"
                       href="/docs/v1.2.0/build-from-source/">v1.2.0</a>
                
                    
                    <a class="dropdown-item"
                       href="/docs/v1.1.0/build-from-source/">v1.1.0</a>
                
                    
                    <a class="dropdown-item"
                       href="/docs/v1.0.0/build-from-source/">v1.0.0</a>
                
                    
                    <a class="dropdown-item"
                       href="/docs/v0.11.0/build-from-source/">v0.11.0</a>
                
                    
                    <a class="dropdown-item"
                       href="/docs/v0.10.0/build-from-source/">v0.10.0</a>
                
                    
                    <a class="dropdown-item"
                       href="/docs/v0.9.0/build-from-source/">v0.9.0</a>
                
                    
                    <a class="dropdown-item"
                       href="/docs/v0.8.1/build-from-source/">v0.8.1</a>
                
                    
                    <a class="dropdown-item"
                       href="/docs/v0.8.0/build-from-source/">v0.8.0</a>
                
                    
                    <a class="dropdown-item"
                       href="/docs/v0.7.1/build-from-source/">v0.7.1</a>
                
                    
                    <a class="dropdown-item"
                       href="/docs/v0.7.0/build-from-source/">v0.7.0</a>
                
                    
                    <a class="dropdown-item"
                       href="/docs/v0.6.0/build-from-source/">v0.6.0</a>
                
                    
                    <a class="dropdown-item"
                       href="/docs/v0.5.0/build-from-source/">v0.5.0</a>
                
                    
                    <a class="dropdown-item"
                       href="/docs/v0.4.0/build-from-source/">v0.4.0</a>
                
                    
                    <a class="dropdown-item"
                       href="/docs/v0.3.0/build-from-source/">v0.3.0</a>
                
            </div>
        
    </div>
</div>
                        <br/>
                        <form class="d-flex align-items-center">
                          <span class="algolia-autocomplete" style="position: relative; display: inline-block; direction: ltr;">
                            <input type="search" class="form-control docsearch-input" id="search-input" placeholder="Search..."
                                   aria-label="Search for..." autocomplete="off" spellcheck="false" role="combobox"
                                   aria-autocomplete="list" aria-expanded="false" aria-owns="algolia-autocomplete-listbox-0"
                                   dir="auto" style="position: relative; vertical-align: top;">
                          </span>
                        </form>
                        <nav class="navigation">
    
    
    
        
        
        
        

        
            <h3>Introduction</h3>
            <ul>
                
                    <li>
                        
                            <a href="/docs/v1.2.0/index.html">About Velero</a>
                        
                    </li>
                
                    <li>
                        
                            <a href="/docs/v1.2.0/how-velero-works">How Velero works</a>
                        
                    </li>
                
                    <li>
                        
                            <a href="/docs/v1.2.0/locations">About locations</a>
                        
                    </li>
                
            </ul>
        
            <h3>Install</h3>
            <ul>
                
                    <li>
                        
                            <a href="/docs/v1.2.0/basic-install">Basic Install</a>
                        
                    </li>
                
                    <li>
                        
                            <a href="/docs/v1.2.0/customize-installation">Customize Installation</a>
                        
                    </li>
                
                    <li>
                        
                            <a href="/docs/v1.2.0/upgrade-to-1.2">Upgrade to 1.2</a>
                        
                    </li>
                
                    <li>
                        
                            <a href="/docs/v1.2.0/supported-providers">Supported providers</a>
                        
                    </li>
                
                    <li>
                        
                            <a href="/docs/v1.2.0/contributions/minio">Evaluation install</a>
                        
                    </li>
                
                    <li>
                        
                            <a href="/docs/v1.2.0/restic">Restic integration</a>
                        
                    </li>
                
                    <li>
                        
                            <a href="/docs/v1.2.0/examples">Examples</a>
                        
                    </li>
                
                    <li>
                        
                            <a href="/docs/v1.2.0/uninstalling">Uninstalling</a>
                        
                    </li>
                
            </ul>
        
            <h3>Use</h3>
            <ul>
                
                    <li>
                        
                            <a href="/docs/v1.2.0/disaster-case">Disaster recovery</a>
                        
                    </li>
                
                    <li>
                        
                            <a href="/docs/v1.2.0/migration-case">Cluster migration</a>
                        
                    </li>
                
                    <li>
                        
                            <a href="/docs/v1.2.0/backup-reference">Backup reference</a>
                        
                    </li>
                
                    <li>
                        
                            <a href="/docs/v1.2.0/restore-reference">Restore reference</a>
                        
                    </li>
                
                    <li>
                        
                            <a href="/docs/v1.2.0/namespace">Run in any namespace</a>
                        
                    </li>
                
                    <li>
                        
                            <a href="/docs/v1.2.0/hooks">Extend with hooks</a>
                        
                    </li>
                
            </ul>
        
            <h3>Plugins</h3>
            <ul>
                
                    <li>
                        
                            <a href="/docs/v1.2.0/overview-plugins">Overview</a>
                        
                    </li>
                
                    <li>
                        
                            <a href="/docs/v1.2.0/custom-plugins">Custom plugins</a>
                        
                    </li>
                
            </ul>
        
            <h3>Troubleshoot</h3>
            <ul>
                
                    <li>
                        
                            <a href="/docs/v1.2.0/troubleshooting">Troubleshooting</a>
                        
                    </li>
                
                    <li>
                        
                            <a href="/docs/v1.2.0/debugging-install">Troubleshoot an install or setup</a>
                        
                    </li>
                
                    <li>
                        
                            <a href="/docs/v1.2.0/debugging-restores">Troubleshoot a restore</a>
                        
                    </li>
                
                    <li>
                        
                            <a href="/docs/v1.2.0/restic#troubleshooting">Troubleshoot Restic</a>
                        
                    </li>
                
            </ul>
        
            <h3>Contribute</h3>
            <ul>
                
                    <li>
                        
                            <a href="/docs/v1.2.0/start-contributing">Start Contributing</a>
                        
                    </li>
                
                    <li>
                        
                            <a href="/docs/v1.2.0/development">Development</a>
                        
                    </li>
                
                    <li>
                        
                            <a href="/docs/v1.2.0/build-from-source">Build from source</a>
                        
                    </li>
                
                    <li>
                        
                            <a href="/docs/v1.2.0/run-locally">Run locally</a>
                        
                    </li>
                
                    <li>
                        
                            <a href="/docs/v1.2.0/code-standards">Code standards</a>
                        
                    </li>
                
                    <li>
                        
                            <a href="/docs/v1.2.0/website-guidelines">Website guidelines</a>
                        
                    </li>
                
            </ul>
        
            <h3>More information</h3>
            <ul>
                
                    <li>
                        
                            <a href="/docs/v1.2.0/output-file-format">Backup file format</a>
                        
                    </li>
                
                    <li>
                        
                            <a href="/docs/v1.2.0/api-types">API types</a>
                        
                    </li>
                
                    <li>
                        
                            <a href="/docs/v1.2.0/faq">FAQ</a>
                        
                    </li>
                
                    <li>
                        
                            <a href="/docs/v1.2.0/zenhub">ZenHub</a>
                        
                    </li>
                
                    <li>
                        
                            <a href="/docs/v1.2.0/support-process">Support Process</a>
                        
                    </li>
                
            </ul>
        
    
</nav>

                    </div>
                    <div class="col-md-8">
                        
    
    <div class="alert alert-primary" role="alert">
        
            <p>
                <i class="fa fa-exclamation-triangle" aria-hidden="true"></i>
                Documentation for version v1.2.0 is no longer actively maintained.
                The version you are currently viewing is a static snapshot.
                For up-to-date documentation, see the <a href="/docs/v1.4/build-from-source/">latest version</a>.
            </p>
        
    </div>

                        <div class="documentation-container">
                            <h1 id="build-from-source">Build from source</h1>
<h2 id="prerequisites">Prerequisites</h2>
<ul>
<li>Access to a Kubernetes cluster, version 1.7 or later.</li>
<li>A DNS server on the cluster</li>
<li><code>kubectl</code> installed</li>
<li>

<a href="https://golang.org/doc/install">Go</a> installed (minimum version 1.8)</li>
</ul>
<h2 id="get-the-source">Get the source</h2>
<h3 id="option-1-get-latest-recommended">Option 1) Get latest (recommended)</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">mkdir $HOME/go
export GOPATH<span style="color:#f92672">=</span>$HOME/go
go get github.com/vmware-tanzu/velero
</code></pre></div><p>Where <code>go</code> is your 

<a href="https://blog.golang.org/organizing-go-code">import path</a> for Go.</p>
<p>For Go development, it is recommended to add the Go import path (<code>$HOME/go</code> in this example) to your path.</p>
<h3 id="option-2-release-archive">Option 2) Release archive</h3>
<p>Download the archive named <code>Source code</code> from the 

<a href="https://github.com/vmware-tanzu/velero/releases">release page</a> and extract it in your Go import path as <code>src/github.com/vmware-tanzu/velero</code>.</p>
<p>Note that the Makefile targets assume building from a git repository. When building from an archive, you will be limited to the <code>go build</code> commands described below.</p>
<h2 id="build">Build</h2>
<p>There are a number of different ways to build <code>velero</code> depending on your needs. This section outlines the main possibilities.</p>
<p>When building by using <code>make</code>, it will place the binaries under <code>_output/bin/$GOOS/$GOARCH</code>. For example, you will find the binary for darwin here: <code>_output/bin/darwin/amd64/velero</code>, and the binary for linux here: <code>_output/bin/linux/amd64/velero</code>. <code>make</code> will also splice version and git commit information in so that <code>velero version</code> displays proper output.</p>
<p>Note: <code>velero install</code> will also use the version information to determine which tagged image to deploy. If you would like to overwrite what image gets deployed, use the <code>image</code> flag (see below for instructions on how to build images).</p>
<h3 id="build-the-binary">Build the binary</h3>
<p>To build the <code>velero</code> binary on your local machine, compiled for your OS and architecture, run one of these two commands:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">go build ./cmd/velero
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">make local
</code></pre></div><h3 id="cross-compiling">Cross compiling</h3>
<p>To build the velero binary targeting linux/amd64 within a build container on your local machine, run:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">make build
</code></pre></div><p>For any specific platform, run <code>make build-&lt;GOOS&gt;-&lt;GOARCH&gt;</code>.</p>
<p>For example, to build for the Mac, run <code>make build-darwin-amd64</code>.</p>
<p>Velero&rsquo;s <code>Makefile</code> has a convenience target, <code>all-build</code>, that builds the following platforms:</p>
<ul>
<li>linux-amd64</li>
<li>linux-arm</li>
<li>linux-arm64</li>
<li>linux-ppc64le</li>
<li>darwin-amd64</li>
<li>windows-amd64</li>
</ul>
<h2 id="making-images-and-updating-velero">Making images and updating Velero</h2>
<p>If after installing Velero you would like to change the image used by its deployment to one that contains your code changes, you may do so by updating the image:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">kubectl -n velero set image deploy/velero velero<span style="color:#f92672">=</span>myimagerepo/velero:$VERSION
</code></pre></div><p>To build a Velero container image, first set the <code>$REGISTRY</code> environment variable. For example, if you want to build the <code>gcr.io/my-registry/velero-amd64:master</code> image, set <code>$REGISTRY</code> to <code>gcr.io/my-registry</code>. If this variable is not set, the default is <code>velero</code>.</p>
<p>Optionally, set the <code>$VERSION</code> environment variable to change the image tag. Then, run:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">make container
</code></pre></div><p>For any specific platform, run <code>ARCH=&lt;GOOS&gt;-&lt;GOARCH&gt; make container</code></p>
<p>For example, to build an image for the Power (ppc64le), run:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">ARCH<span style="color:#f92672">=</span>linux-ppc64le make container
</code></pre></div><p><em>Note: By default, ARCH is set to linux-amd64</em></p>
<p>To push your image to the registry. For example, if you want to push the <code>gcr.io/my-registry/velero-amd64:master</code> image, run:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">make push
</code></pre></div><p>For any specific platform, run <code>ARCH=&lt;GOOS&gt;-&lt;GOARCH&gt; make push</code></p>
<p>For example, to push image for the Power (ppc64le), run:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">ARCH<span style="color:#f92672">=</span>linux-ppc64le make push
</code></pre></div><p><em>Note: By default, ARCH is set to linux-amd64</em></p>
<p>To create and push your manifest to the registry. For example, if you want to create and push the <code>gcr.io/my-registry/velero:master</code> manifest, run:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">make manifest
</code></pre></div><p>For any specific platform, run <code>MANIFEST_PLATFORMS=&lt;GOARCH&gt; make manifest</code></p>
<p>For example, to create and push manifest only for amd64, run:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">MANIFEST_PLATFORMS<span style="color:#f92672">=</span>amd64 make manifest
</code></pre></div><p><em>Note: By default, MANIFEST_PLATFORMS is set to amd64, ppc64le</em></p>
<p>To run the entire workflow, run:</p>
<p><code>REGISTRY=&lt;$REGISTRY&gt; VERSION=&lt;$VERSION&gt; ARCH=&lt;GOOS&gt;-&lt;GOARCH&gt; MANIFEST_PLATFORMS=&lt;GOARCH&gt; make container push manifest</code></p>
<p>For example, to run the workflow only for amd64</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">REGISTRY<span style="color:#f92672">=</span>myrepo VERSION<span style="color:#f92672">=</span>foo MANIFEST_PLATFORMS<span style="color:#f92672">=</span>amd64 make container push manifest
</code></pre></div><p><em>Note: By default, ARCH is set to linux-amd64</em></p>
<p>For example, to run the workflow only for ppc64le</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">REGISTRY<span style="color:#f92672">=</span>myrepo VERSION<span style="color:#f92672">=</span>foo ARCH<span style="color:#f92672">=</span>linux-ppc64le MANIFEST_PLATFORMS<span style="color:#f92672">=</span>ppc64le make container push manifest
</code></pre></div><p>For example, to run the workflow for all supported platforms</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">REGISTRY<span style="color:#f92672">=</span>myrepo VERSION<span style="color:#f92672">=</span>foo make all-containers all-push all-manifests
</code></pre></div><p>Note: if you want to update the image but not change its name, you will have to trigger Kubernetes to pick up the new image. One way of doing so is by deleting the Velero deployment pod:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">kubectl -n velero delete pods -l deploy<span style="color:#f92672">=</span>velero
</code></pre></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="section section-background-darkest-blue">
    <div class="section-content">
        <div class="row">
            <div class="col-xs-12 col-sm-6 col-lg-8">
                <h5>Getting Started</h5>
                <p>To help you get started, see the documentation.</p>
            </div>
            <div class="col-xs-12 col-sm-6 col-lg-3 offset-lg-1">
                <p><strong></strong></p>
                <a href="/docs"
                   class="btn btn-sm btn-primary btn-no-border">Documentation</a>
            </div>
        </div>
    </div>
</div>

<footer class="section site-footer">
    <div class="section-content">
        <div class="row justify-content-between align-items-center">
            <div class="col-12 col-md-8 mb-3 mb-md-0">
                <ul class="social-links text-center text-md-left">
                    
                        <li>
                            
                                <i class="fab fa-twitter fa-lg fa-fw mr-1"></i>
                            
                            <a href="https://twitter.com/projectvelero">Twitter</a>
                        </li>
                    
                        <li>
                            
                                <i class="fab fa-slack fa-lg fa-fw mr-1"></i>
                            
                            <a href="https://kubernetes.slack.com/messages/velero">Slack</a>
                        </li>
                    
                        <li>
                            
                                <i class="fas fa-users fa-lg fa-fw mr-1"></i>
                            
                            <a href="https://groups.google.com/forum/#!forum/projectvelero">Google Groups</a>
                        </li>
                    
                        <li>
                            
                                <i class="fa fa-rss fa-lg fa-fw mr-1"></i>
                            
                            <a href="feed.xml">RSS</a>
                        </li>
                    
                        <li>
                            
                                <i class="fab fa-github fa-lg fa-fw mr-1"></i>
                            
                            <a href="https://github.com/vmware-tanzu/velero">GitHub</a>
                        </li>
                    
                </ul>
            </div>
            <div class="col-12 col-md-4 text-center text-md-right">
                <a href="/" aria-label="Velero homepage"><img src="/img/Velero.svg" class="logo"
                                                              alt="Homepage"/></a>
            </div>
        </div>
        <div class="row align-items-center">
            <div class="col copyright text-center text-md-right mt-4">
                &copy; 2020 Velero Authors.
                <a href="http://vmware.github.io/" class="vm-logo">A VMware-backed project. <img
                            src="/img/vm-logo.png" alt="VMware logo"/></a>
            </div>
        </div>
    </div>
</footer>


<script defer src="https://use.fontawesome.com/releases/v5.8.1/js/all.js"
        integrity="sha384-g5uSoOSBd7KkhAMlnQILrecXvzst9TdC09/VM+pjDTCM+1il8RHz5fKANTFFb+gQ"
        crossorigin="anonymous"></script>
<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"
        integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
        crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"
        integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
        crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" crossorigin="anonymous"></script>

<script src="/js/jquery.matchHeight.js?1593121911"></script>
<script src="/js/scripts.js?1593121911"></script>

    </div>
</div>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script>
<script type="text/javascript"> docsearch({
        apiKey: '3d80f66bb5ecf85f8e2760caef383f24',
        indexName: 'velero',
        inputSelector: '.docsearch-input',
        algoliaOptions: {'facetFilters': ["version:v1.2.0"]},
        debug: false 
    });
</script>
</body>

</html>
