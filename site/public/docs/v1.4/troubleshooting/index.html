<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
  <link rel="icon" href="/favicon.ico" type="image/x-icon">
  
  
  <link rel="stylesheet" href="/styles.666a5dc1cd80e47092a71103358e46b56345de6f3044680f856f219cbc2fe91b.css" integrity="sha256-Zmpdwc2A5HCSpxEDNY5GtWNF3m8wRGgPhW8hnLwv6Rs=">

</head>



    
    <meta name="robots" content="noindex">




    <title>Velero Docs - </title>


<body id="docs">
<div class="container-fluid site-outer-container">
    <div class="site-container">
        <header class="site-header">
    <div class="site-header-content">
        <div class="logo">
            <a href="/" aria-label="Velero homepage"><img src="/img/Velero.svg" class="logo" alt="Homepage"/></a>
        </div>
        <ul class="nav-menu" id="header-nav">
            <li class="home"><a href="/" title="Velero">Home</a></li>
            <li class="docs"><a href="/docs/v1.4" title="Documentation">Documentation</a></li>
            <li class="plugins"><a href="/plugins" title="Plugins">Plugins</a></li>
            <li class="blog"><a href="/blog" title="Blog Posts">Blog</a></li>
            <li class="community"><a href="/community" title="Community">Community</a></li>
            <li class="resources"><a href="/resources" title="Resources">Resources</a></li>
        </ul>
        <div class="nav-mobile-link">
            <a href="javascript:void(0);" id="nav-mobile-toggle"></a>
        </div>
    </div>
</header>

        <div class="post-single-hero post-single-hero-short bg-color-med-blue">
            <div class="section">
                <div class="section-content">
                    <h1>Documentation</h1>
                </div>
            </div>
        </div>
        <div class="section section-card pt-4 pb-0">
            <div class="container container-max">
                <div class="row">
                    <div class="col-md-3 toc">
                        <div class="row">
    <div class="dropdown mb-2">
        
            <button class="btn btn-primary dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown"
                    aria-haspopup="true" aria-expanded="false">
                v1.4
            </button>
            <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                
                
                

                
                    
                    <a class="dropdown-item"
                       href="/docs/master/troubleshooting/">master</a>
                
                    
                    <a class="dropdown-item"
                       href="/docs/v1.4/troubleshooting/">v1.4</a>
                
                    
                    <a class="dropdown-item"
                       href="/docs/v1.3.2/troubleshooting/">v1.3.2</a>
                
                    
                    <a class="dropdown-item"
                       href="/docs/v1.3.1/troubleshooting/">v1.3.1</a>
                
                    
                    <a class="dropdown-item"
                       href="/docs/v1.3.0/troubleshooting/">v1.3.0</a>
                
                    
                    <a class="dropdown-item"
                       href="/docs/v1.2.0/troubleshooting/">v1.2.0</a>
                
                    
                    <a class="dropdown-item"
                       href="/docs/v1.1.0/troubleshooting/">v1.1.0</a>
                
                    
                    <a class="dropdown-item"
                       href="/docs/v1.0.0/troubleshooting/">v1.0.0</a>
                
                    
                    <a class="dropdown-item"
                       href="/docs/v0.11.0/troubleshooting/">v0.11.0</a>
                
                    
                    <a class="dropdown-item"
                       href="/docs/v0.10.0/troubleshooting/">v0.10.0</a>
                
                    
                    <a class="dropdown-item"
                       href="/docs/v0.9.0/troubleshooting/">v0.9.0</a>
                
                    
                    <a class="dropdown-item"
                       href="/docs/v0.8.1/troubleshooting/">v0.8.1</a>
                
                    
                    <a class="dropdown-item"
                       href="/docs/v0.8.0/troubleshooting/">v0.8.0</a>
                
                    
                    <a class="dropdown-item"
                       href="/docs/v0.7.1/troubleshooting/">v0.7.1</a>
                
                    
                    <a class="dropdown-item"
                       href="/docs/v0.7.0/troubleshooting/">v0.7.0</a>
                
                    
                    <a class="dropdown-item"
                       href="/docs/v0.6.0/troubleshooting/">v0.6.0</a>
                
                    
                    <a class="dropdown-item"
                       href="/docs/v0.5.0/troubleshooting/">v0.5.0</a>
                
                    
                    <a class="dropdown-item"
                       href="/docs/v0.4.0/troubleshooting/">v0.4.0</a>
                
                    
                    <a class="dropdown-item"
                       href="/docs/v0.3.0/troubleshooting/">v0.3.0</a>
                
            </div>
        
    </div>
</div>
                        <br/>
                        <form class="d-flex align-items-center">
                          <span class="algolia-autocomplete" style="position: relative; display: inline-block; direction: ltr;">
                            <input type="search" class="form-control docsearch-input" id="search-input" placeholder="Search..."
                                   aria-label="Search for..." autocomplete="off" spellcheck="false" role="combobox"
                                   aria-autocomplete="list" aria-expanded="false" aria-owns="algolia-autocomplete-listbox-0"
                                   dir="auto" style="position: relative; vertical-align: top;">
                          </span>
                        </form>
                        <nav class="navigation">
    
    
    
        
        
        
        

        
            <h3>Introduction</h3>
            <ul>
                
                    <li>
                        
                            <a href="/docs/v1.4/index.html">About Velero</a>
                        
                    </li>
                
                    <li>
                        
                            <a href="/docs/v1.4/how-velero-works">How Velero works</a>
                        
                    </li>
                
                    <li>
                        
                            <a href="/docs/v1.4/locations">About locations</a>
                        
                    </li>
                
            </ul>
        
            <h3>Install</h3>
            <ul>
                
                    <li>
                        
                            <a href="/docs/v1.4/basic-install">Basic Install</a>
                        
                    </li>
                
                    <li>
                        
                            <a href="/docs/v1.4/customize-installation">Customize Installation</a>
                        
                    </li>
                
                    <li>
                        
                            <a href="/docs/v1.4/upgrade-to-1.4">Upgrade to 1.4</a>
                        
                    </li>
                
                    <li>
                        
                            <a href="/docs/v1.4/supported-providers">Supported providers</a>
                        
                    </li>
                
                    <li>
                        
                            <a href="/docs/v1.4/contributions/minio">Evaluation install</a>
                        
                    </li>
                
                    <li>
                        
                            <a href="/docs/v1.4/restic">Restic integration</a>
                        
                    </li>
                
                    <li>
                        
                            <a href="/docs/v1.4/examples">Examples</a>
                        
                    </li>
                
                    <li>
                        
                            <a href="/docs/v1.4/uninstalling">Uninstalling</a>
                        
                    </li>
                
            </ul>
        
            <h3>Use</h3>
            <ul>
                
                    <li>
                        
                            <a href="/docs/v1.4/disaster-case">Disaster recovery</a>
                        
                    </li>
                
                    <li>
                        
                            <a href="/docs/v1.4/migration-case">Cluster migration</a>
                        
                    </li>
                
                    <li>
                        
                            <a href="/docs/v1.4/backup-reference">Backup reference</a>
                        
                    </li>
                
                    <li>
                        
                            <a href="/docs/v1.4/restore-reference">Restore reference</a>
                        
                    </li>
                
                    <li>
                        
                            <a href="/docs/v1.4/namespace">Run in any namespace</a>
                        
                    </li>
                
                    <li>
                        
                            <a href="/docs/v1.4/hooks">Extend with hooks</a>
                        
                    </li>
                
                    <li>
                        
                            <a href="/docs/v1.4/csi">CSI Support (beta)</a>
                        
                    </li>
                
                    <li>
                        
                            <a href="/docs/v1.4/self-signed-certificates">Verifying Self-signed Certificates</a>
                        
                    </li>
                
            </ul>
        
            <h3>Plugins</h3>
            <ul>
                
                    <li>
                        
                            <a href="/docs/v1.4/overview-plugins">Overview</a>
                        
                    </li>
                
                    <li>
                        
                            <a href="/docs/v1.4/custom-plugins">Custom plugins</a>
                        
                    </li>
                
            </ul>
        
            <h3>Troubleshoot</h3>
            <ul>
                
                    <li>
                        
                            <a href="/docs/v1.4/troubleshooting">Troubleshooting</a>
                        
                    </li>
                
                    <li>
                        
                            <a href="/docs/v1.4/debugging-install">Troubleshoot an install or setup</a>
                        
                    </li>
                
                    <li>
                        
                            <a href="/docs/v1.4/debugging-restores">Troubleshoot a restore</a>
                        
                    </li>
                
                    <li>
                        
                            <a href="/docs/v1.4/restic#troubleshooting">Troubleshoot Restic</a>
                        
                    </li>
                
            </ul>
        
            <h3>Contribute</h3>
            <ul>
                
                    <li>
                        
                            <a href="/docs/v1.4/start-contributing">Start Contributing</a>
                        
                    </li>
                
                    <li>
                        
                            <a href="/docs/v1.4/development">Development</a>
                        
                    </li>
                
                    <li>
                        
                            <a href="/docs/v1.4/build-from-source">Build from source</a>
                        
                    </li>
                
                    <li>
                        
                            <a href="/docs/v1.4/run-locally">Run locally</a>
                        
                    </li>
                
                    <li>
                        
                            <a href="/docs/v1.4/code-standards">Code standards</a>
                        
                    </li>
                
                    <li>
                        
                            <a href="/docs/v1.4/website-guidelines">Website guidelines</a>
                        
                    </li>
                
            </ul>
        
            <h3>More information</h3>
            <ul>
                
                    <li>
                        
                            <a href="/docs/v1.4/output-file-format">Backup file format</a>
                        
                    </li>
                
                    <li>
                        
                            <a href="/docs/v1.4/api-types">API types</a>
                        
                    </li>
                
                    <li>
                        
                            <a href="/docs/v1.4/faq">FAQ</a>
                        
                    </li>
                
                    <li>
                        
                            <a href="/docs/v1.4/zenhub">ZenHub</a>
                        
                    </li>
                
                    <li>
                        
                            <a href="/docs/v1.4/support-process">Support Process</a>
                        
                    </li>
                
            </ul>
        
    
</nav>

                    </div>
                    <div class="col-md-8">
                        
                        <div class="documentation-container">
                            <h1 id="troubleshooting">Troubleshooting</h1>
<p>These tips can help you troubleshoot known issues. If they don&rsquo;t help, you can 

<a href="https://github.com/vmware-tanzu/velero/issues">file an issue</a>, or talk to us on the 

<a href="https://kubernetes.slack.com/messages/velero">#velero channel</a> on the Kubernetes Slack server.</p>
<ul>
<li>

    

<a href="">Troubleshooting</a>
<ul>
<li>

    

<a href="">Debug installation/ setup issues</a></li>
<li>

    

<a href="">Debug restores</a></li>
<li>

    

<a href="">General troubleshooting information</a>
<ul>
<li>

    

<a href="">Getting velero debug logs</a></li>
</ul>
</li>
<li>

    

<a href="">Known issue with restoring LoadBalancer Service</a></li>
<li>

    

<a href="">Miscellaneous issues</a>
<ul>
<li>

    

<a href="">Velero reports <code>custom resource not found</code> errors when starting up.</a></li>
<li>

    

<a href=""><code>velero backup logs</code> returns a <code>SignatureDoesNotMatch</code> error</a></li>
</ul>
</li>
<li>

    

<a href="">Velero (or a pod it was backing up) restarted during a backup and the backup is stuck InProgress</a></li>
<li>

    

<a href="">Velero is not publishing prometheus metrics</a></li>
</ul>
</li>
</ul>
<h2 id="debug-installation-setup-issues">Debug installation/ setup issues</h2>
<ul>
<li>

    

<a href="/docs/v1.4/debugging-install/">Debug installation/setup issues</a></li>
</ul>
<h2 id="debug-restores">Debug restores</h2>
<ul>
<li>

    

<a href="/docs/v1.4/debugging-restores/">Debug restores</a></li>
</ul>
<h2 id="general-troubleshooting-information">General troubleshooting information</h2>
<p>You can use the <code>velero bug</code> command to open a 

<a href="https://github.com/vmware-tanzu/velero/issues">Github issue</a> by launching a browser window with some prepopulated values. Values included are OS, CPU architecture, <code>kubectl</code> client and server versions (if available) and the <code>velero</code> client version. This information isn&rsquo;t submitted to Github until you click the <code>Submit new issue</code> button in the Github UI, so feel free to add, remove or update whatever information you like.</p>
<p>Some general commands for troubleshooting that may be helpful:</p>
<ul>
<li><code>velero backup describe &lt;backupName&gt;</code> - describe the details of a backup</li>
<li><code>velero backup logs &lt;backupName&gt;</code> - fetch the logs for this specific backup. Useful for viewing failures and warnings, including resources that could not be backed up.</li>
<li><code>velero restore describe &lt;restoreName&gt;</code> - describe the details of a restore</li>
<li><code>velero restore logs &lt;restoreName&gt;</code> - fetch the logs for this specific restore. Useful for viewing failures and warnings, including resources that could not be restored.</li>
<li><code>kubectl logs deployment/velero -n velero</code> - fetch the logs of the Velero server pod. This provides the output of the Velero server processes.</li>
</ul>
<h3 id="getting-velero-debug-logs">Getting velero debug logs</h3>
<p>You can increase the verbosity of the Velero server by editing your Velero deployment to look like this:</p>
<pre><code>kubectl edit deployment/velero -n velero
...
   containers:
     - name: velero
       image: velero/velero:latest
       command:
         - /velero
       args:
         - server
         - --log-level # Add this line
         - debug       # Add this line
...
</code></pre><h2 id="known-issue-with-restoring-loadbalancer-service">Known issue with restoring LoadBalancer Service</h2>
<p>Because of how Kubernetes handles Service objects of <code>type=LoadBalancer</code>, when you restore these objects you might encounter an issue with changed values for Service UIDs. Kubernetes automatically generates the name of the cloud resource based on the Service UID, which is different when restored, resulting in a different name for the cloud load balancer. If the DNS CNAME for your application points to the DNS name of your cloud load balancer, you&rsquo;ll need to update the CNAME pointer when you perform a Velero restore.</p>
<p>Alternatively, you might be able to use the Service&rsquo;s <code>spec.loadBalancerIP</code> field to keep connections valid, if your cloud provider supports this value. See 

<a href="https://kubernetes.io/docs/concepts/services-networking/service/#loadbalancer">the Kubernetes documentation about Services of Type LoadBalancer</a>.</p>
<h2 id="miscellaneous-issues">Miscellaneous issues</h2>
<h3 id="velero-reports-custom-resource-not-found-errors-when-starting-up">Velero reports <code>custom resource not found</code> errors when starting up.</h3>
<p>Velero&rsquo;s server will not start if the required Custom Resource Definitions are not found in Kubernetes. Run <code>velero install</code> again to install any missing custom resource definitions.</p>
<h3 id="velero-backup-logs-returns-a-signaturedoesnotmatch-error"><code>velero backup logs</code> returns a <code>SignatureDoesNotMatch</code> error</h3>
<p>Downloading artifacts from object storage utilizes temporary, signed URLs. In the case of S3-compatible
providers, such as Ceph, there may be differences between their implementation and the official S3
API that cause errors.</p>
<p>Here are some things to verify if you receive <code>SignatureDoesNotMatch</code> errors:</p>
<ul>
<li>Make sure your S3-compatible layer is using 

<a href="https://docs.aws.amazon.com/AmazonS3/latest/API/sig-v4-authenticating-requests.html">signature version 4</a> (such as Ceph RADOS v12.2.7)</li>
<li>For Ceph, try using a native Ceph account for credentials instead of external providers such as OpenStack Keystone</li>
</ul>
<h2 id="velero-or-a-pod-it-was-backing-up-restarted-during-a-backup-and-the-backup-is-stuck-inprogress">Velero (or a pod it was backing up) restarted during a backup and the backup is stuck InProgress</h2>
<p>Velero cannot currently resume backups that were interrupted. Backups stuck in the <code>InProgress</code> phase can be deleted with <code>kubectl delete backup &lt;name&gt; -n &lt;velero-namespace&gt;</code>.
Backups in the <code>InProgress</code> phase have not uploaded any files to object storage.</p>
<h2 id="velero-is-not-publishing-prometheus-metrics">Velero is not publishing prometheus metrics</h2>
<p>Steps to troubleshoot:</p>
<ul>
<li>Confirm that your velero deployment has metrics publishing enabled. The 

<a href="https://github.com/vmware-tanzu/helm-charts/blob/master/charts/velero">latest Velero helm charts</a> have been setup with 

<a href="https://github.com/vmware-tanzu/helm-charts/blob/master/charts/velero/values.yaml#L44">metrics enabled by default</a>.</li>
<li>Confirm that the Velero server pod exposes the port on which the metrics server listens on. By default, this value is 8085.</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml">          <span style="color:#66d9ef">ports</span>:
          - <span style="color:#66d9ef">containerPort</span>: <span style="color:#ae81ff">8085</span>
            <span style="color:#66d9ef">name</span>: metrics
            <span style="color:#66d9ef">protocol</span>: TCP
</code></pre></div><ul>
<li>Confirm that the metric server is listening for and responding to connections on this port. This can be done using 

<a href="https://kubectl.docs.kubernetes.io/pages/container_debugging/port_forward_to_pods.html">port-forwarding</a> as shown below</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ kubectl -n &lt;YOUR_VELERO_NAMESPACE&gt; port-forward &lt;YOUR_VELERO_POD&gt; 8085:8085
Forwarding from 127.0.0.1:8085 -&gt; <span style="color:#ae81ff">8085</span>
Forwarding from <span style="color:#f92672">[</span>::1<span style="color:#f92672">]</span>:8085 -&gt; <span style="color:#ae81ff">8085</span>
.
.
.
</code></pre></div><p>Now, visiting http://localhost:8085/metrics on a browser should show the metrics that are being scraped from Velero.</p>
<ul>
<li>Confirm that the Velero server pod has the nessary 

<a href="https://github.com/vmware-tanzu/helm-charts/blob/master/charts/velero/values.yaml#L49-L52">annotations</a> for prometheus to scrape metrics.</li>
<li>Confirm, from the Prometheus UI, that the Velero pod is one of the targets being scraped from Prometheus.</li>
</ul>

                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="section section-background-darkest-blue">
    <div class="section-content">
        <div class="row">
            <div class="col-xs-12 col-sm-6 col-lg-8">
                <h5>Getting Started</h5>
                <p>To help you get started, see the documentation.</p>
            </div>
            <div class="col-xs-12 col-sm-6 col-lg-3 offset-lg-1">
                <p><strong></strong></p>
                <a href="/docs"
                   class="btn btn-sm btn-primary btn-no-border">Documentation</a>
            </div>
        </div>
    </div>
</div>

<footer class="section site-footer">
    <div class="section-content">
        <div class="row justify-content-between align-items-center">
            <div class="col-12 col-md-8 mb-3 mb-md-0">
                <ul class="social-links text-center text-md-left">
                    
                        <li>
                            
                                <i class="fab fa-twitter fa-lg fa-fw mr-1"></i>
                            
                            <a href="https://twitter.com/projectvelero">Twitter</a>
                        </li>
                    
                        <li>
                            
                                <i class="fab fa-slack fa-lg fa-fw mr-1"></i>
                            
                            <a href="https://kubernetes.slack.com/messages/velero">Slack</a>
                        </li>
                    
                        <li>
                            
                                <i class="fas fa-users fa-lg fa-fw mr-1"></i>
                            
                            <a href="https://groups.google.com/forum/#!forum/projectvelero">Google Groups</a>
                        </li>
                    
                        <li>
                            
                                <i class="fa fa-rss fa-lg fa-fw mr-1"></i>
                            
                            <a href="feed.xml">RSS</a>
                        </li>
                    
                        <li>
                            
                                <i class="fab fa-github fa-lg fa-fw mr-1"></i>
                            
                            <a href="https://github.com/vmware-tanzu/velero">GitHub</a>
                        </li>
                    
                </ul>
            </div>
            <div class="col-12 col-md-4 text-center text-md-right">
                <a href="/" aria-label="Velero homepage"><img src="/img/Velero.svg" class="logo"
                                                              alt="Homepage"/></a>
            </div>
        </div>
        <div class="row align-items-center">
            <div class="col copyright text-center text-md-right mt-4">
                &copy; 2020 Velero Authors.
                <a href="http://vmware.github.io/" class="vm-logo">A VMware-backed project. <img
                            src="/img/vm-logo.png" alt="VMware logo"/></a>
            </div>
        </div>
    </div>
</footer>


<script defer src="https://use.fontawesome.com/releases/v5.8.1/js/all.js"
        integrity="sha384-g5uSoOSBd7KkhAMlnQILrecXvzst9TdC09/VM+pjDTCM+1il8RHz5fKANTFFb+gQ"
        crossorigin="anonymous"></script>
<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"
        integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
        crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"
        integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
        crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" crossorigin="anonymous"></script>

<script src="/js/jquery.matchHeight.js?1593121911"></script>
<script src="/js/scripts.js?1593121911"></script>

    </div>
</div>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script>
<script type="text/javascript"> docsearch({
        apiKey: '3d80f66bb5ecf85f8e2760caef383f24',
        indexName: 'velero',
        inputSelector: '.docsearch-input',
        algoliaOptions: {'facetFilters': ["version:v1.4"]},
        debug: false 
    });
</script>
</body>

</html>
