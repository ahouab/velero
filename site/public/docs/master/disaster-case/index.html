<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
  <link rel="icon" href="/favicon.ico" type="image/x-icon">
  
  
  <link rel="stylesheet" href="/styles.666a5dc1cd80e47092a71103358e46b56345de6f3044680f856f219cbc2fe91b.css" integrity="sha256-Zmpdwc2A5HCSpxEDNY5GtWNF3m8wRGgPhW8hnLwv6Rs=">

</head>



    
    <meta name="robots" content="noindex">




    <title>Velero Docs - </title>


<body id="docs">
<div class="container-fluid site-outer-container">
    <div class="site-container">
        <header class="site-header">
    <div class="site-header-content">
        <div class="logo">
            <a href="/" aria-label="Velero homepage"><img src="/img/Velero.svg" class="logo" alt="Homepage"/></a>
        </div>
        <ul class="nav-menu" id="header-nav">
            <li class="home"><a href="/" title="Velero">Home</a></li>
            <li class="docs"><a href="/docs/v1.4" title="Documentation">Documentation</a></li>
            <li class="plugins"><a href="/plugins" title="Plugins">Plugins</a></li>
            <li class="blog"><a href="/blog" title="Blog Posts">Blog</a></li>
            <li class="community"><a href="/community" title="Community">Community</a></li>
            <li class="resources"><a href="/resources" title="Resources">Resources</a></li>
        </ul>
        <div class="nav-mobile-link">
            <a href="javascript:void(0);" id="nav-mobile-toggle"></a>
        </div>
    </div>
</header>

        <div class="post-single-hero post-single-hero-short bg-color-med-blue">
            <div class="section">
                <div class="section-content">
                    <h1>Documentation</h1>
                </div>
            </div>
        </div>
        <div class="section section-card pt-4 pb-0">
            <div class="container container-max">
                <div class="row">
                    <div class="col-md-3 toc">
                        <div class="row">
    <div class="dropdown mb-2">
        
            <button class="btn btn-primary dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown"
                    aria-haspopup="true" aria-expanded="false">
                master
            </button>
            <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                
                
                

                
                    
                    <a class="dropdown-item"
                       href="/docs/master/disaster-case/">master</a>
                
                    
                    <a class="dropdown-item"
                       href="/docs/v1.4/disaster-case/">v1.4</a>
                
                    
                    <a class="dropdown-item"
                       href="/docs/v1.3.2/disaster-case/">v1.3.2</a>
                
                    
                    <a class="dropdown-item"
                       href="/docs/v1.3.1/disaster-case/">v1.3.1</a>
                
                    
                    <a class="dropdown-item"
                       href="/docs/v1.3.0/disaster-case/">v1.3.0</a>
                
                    
                    <a class="dropdown-item"
                       href="/docs/v1.2.0/disaster-case/">v1.2.0</a>
                
                    
                    <a class="dropdown-item"
                       href="/docs/v1.1.0/disaster-case/">v1.1.0</a>
                
                    
                    <a class="dropdown-item"
                       href="/docs/v1.0.0/disaster-case/">v1.0.0</a>
                
                    
                    <a class="dropdown-item"
                       href="/docs/v0.11.0/disaster-case/">v0.11.0</a>
                
                    
                    <a class="dropdown-item"
                       href="/docs/v0.10.0/disaster-case/">v0.10.0</a>
                
                    
                    <a class="dropdown-item"
                       href="/docs/v0.9.0/disaster-case/">v0.9.0</a>
                
                    
                    <a class="dropdown-item"
                       href="/docs/v0.8.1/disaster-case/">v0.8.1</a>
                
                    
                    <a class="dropdown-item"
                       href="/docs/v0.8.0/disaster-case/">v0.8.0</a>
                
                    
                    <a class="dropdown-item"
                       href="/docs/v0.7.1/disaster-case/">v0.7.1</a>
                
                    
                    <a class="dropdown-item"
                       href="/docs/v0.7.0/disaster-case/">v0.7.0</a>
                
                    
                    <a class="dropdown-item"
                       href="/docs/v0.6.0/disaster-case/">v0.6.0</a>
                
                    
                    <a class="dropdown-item"
                       href="/docs/v0.5.0/disaster-case/">v0.5.0</a>
                
                    
                    <a class="dropdown-item"
                       href="/docs/v0.4.0/disaster-case/">v0.4.0</a>
                
                    
                    <a class="dropdown-item"
                       href="/docs/v0.3.0/disaster-case/">v0.3.0</a>
                
            </div>
        
    </div>
</div>
                        <br/>
                        <form class="d-flex align-items-center">
                          <span class="algolia-autocomplete" style="position: relative; display: inline-block; direction: ltr;">
                            <input type="search" class="form-control docsearch-input" id="search-input" placeholder="Search..."
                                   aria-label="Search for..." autocomplete="off" spellcheck="false" role="combobox"
                                   aria-autocomplete="list" aria-expanded="false" aria-owns="algolia-autocomplete-listbox-0"
                                   dir="auto" style="position: relative; vertical-align: top;">
                          </span>
                        </form>
                        <nav class="navigation">
    
    
    
        
        
        
        

        
            <h3>Introduction</h3>
            <ul>
                
                    <li>
                        
                            <a href="/docs/master/index.html">About Velero</a>
                        
                    </li>
                
                    <li>
                        
                            <a href="/docs/master/how-velero-works">How Velero works</a>
                        
                    </li>
                
                    <li>
                        
                            <a href="/docs/master/locations">About locations</a>
                        
                    </li>
                
            </ul>
        
            <h3>Install</h3>
            <ul>
                
                    <li>
                        
                            <a href="/docs/master/basic-install">Basic Install</a>
                        
                    </li>
                
                    <li>
                        
                            <a href="/docs/master/customize-installation">Customize Installation</a>
                        
                    </li>
                
                    <li>
                        
                            <a href="/docs/master/upgrade-to-1.3">Upgrade to 1.3</a>
                        
                    </li>
                
                    <li>
                        
                            <a href="/docs/master/supported-providers">Supported providers</a>
                        
                    </li>
                
                    <li>
                        
                            <a href="/docs/master/contributions/minio">Evaluation install</a>
                        
                    </li>
                
                    <li>
                        
                            <a href="/docs/master/restic">Restic integration</a>
                        
                    </li>
                
                    <li>
                        
                            <a href="/docs/master/examples">Examples</a>
                        
                    </li>
                
                    <li>
                        
                            <a href="/docs/master/uninstalling">Uninstalling</a>
                        
                    </li>
                
            </ul>
        
            <h3>Use</h3>
            <ul>
                
                    <li>
                        
                            <a href="/docs/master/disaster-case">Disaster recovery</a>
                        
                    </li>
                
                    <li>
                        
                            <a href="/docs/master/migration-case">Cluster migration</a>
                        
                    </li>
                
                    <li>
                        
                            <a href="/docs/master/backup-reference">Backup reference</a>
                        
                    </li>
                
                    <li>
                        
                            <a href="/docs/master/restore-reference">Restore reference</a>
                        
                    </li>
                
                    <li>
                        
                            <a href="/docs/master/namespace">Run in any namespace</a>
                        
                    </li>
                
                    <li>
                        
                            <a href="/docs/master/hooks">Extend with hooks</a>
                        
                    </li>
                
                    <li>
                        
                            <a href="/docs/master/csi">CSI Support (beta)</a>
                        
                    </li>
                
                    <li>
                        
                            <a href="/docs/master/self-signed-certificates">Verifying Self-signed Certificates</a>
                        
                    </li>
                
            </ul>
        
            <h3>Plugins</h3>
            <ul>
                
                    <li>
                        
                            <a href="/docs/master/overview-plugins">Overview</a>
                        
                    </li>
                
                    <li>
                        
                            <a href="/docs/master/custom-plugins">Custom plugins</a>
                        
                    </li>
                
            </ul>
        
            <h3>Troubleshoot</h3>
            <ul>
                
                    <li>
                        
                            <a href="/docs/master/troubleshooting">Troubleshooting</a>
                        
                    </li>
                
                    <li>
                        
                            <a href="/docs/master/debugging-install">Troubleshoot an install or setup</a>
                        
                    </li>
                
                    <li>
                        
                            <a href="/docs/master/debugging-restores">Troubleshoot a restore</a>
                        
                    </li>
                
                    <li>
                        
                            <a href="/docs/master/restic#troubleshooting">Troubleshoot Restic</a>
                        
                    </li>
                
            </ul>
        
            <h3>Contribute</h3>
            <ul>
                
                    <li>
                        
                            <a href="/docs/master/start-contributing">Start Contributing</a>
                        
                    </li>
                
                    <li>
                        
                            <a href="/docs/master/development">Development</a>
                        
                    </li>
                
                    <li>
                        
                            <a href="/docs/master/build-from-source">Build from source</a>
                        
                    </li>
                
                    <li>
                        
                            <a href="/docs/master/run-locally">Run locally</a>
                        
                    </li>
                
                    <li>
                        
                            <a href="/docs/master/code-standards">Code standards</a>
                        
                    </li>
                
                    <li>
                        
                            <a href="/docs/master/website-guidelines">Website guidelines</a>
                        
                    </li>
                
            </ul>
        
            <h3>More information</h3>
            <ul>
                
                    <li>
                        
                            <a href="/docs/master/output-file-format">Backup file format</a>
                        
                    </li>
                
                    <li>
                        
                            <a href="/docs/master/api-types">API types</a>
                        
                    </li>
                
                    <li>
                        
                            <a href="/docs/master/faq">FAQ</a>
                        
                    </li>
                
                    <li>
                        
                            <a href="/docs/master/zenhub">ZenHub</a>
                        
                    </li>
                
                    <li>
                        
                            <a href="/docs/master/support-process">Support Process</a>
                        
                    </li>
                
            </ul>
        
    
</nav>

                    </div>
                    <div class="col-md-8">
                        
    
    <div class="alert alert-primary" role="alert">
        
            <p>
                <i class="fa fa-exclamation-triangle" aria-hidden="true"></i>
                This is the documentation for the latest development version of Velero. Both code and docs may be
                unstable, and these docs are not guaranteed to be up to date or correct. See the
                <a href="/docs/v1.4/disaster-case/">latest version</a>.
            </p>
        
    </div>

                        <div class="documentation-container">
                            <h1 id="disaster-recovery">Disaster recovery</h1>
<p><em>Using Schedules and Read-Only Backup Storage Locations</em></p>
<p>If you periodically back up your cluster&rsquo;s resources, you are able to return to a previous state in case of some unexpected mishap, such as a service outage. Doing so with Velero looks like the following:</p>
<ol>
<li>
<p>After you first run the Velero server on your cluster, set up a daily backup (replacing <code>&lt;SCHEDULE NAME&gt;</code> in the command as desired):</p>
<pre><code>velero schedule create &lt;SCHEDULE NAME&gt; --schedule &quot;0 7 * * *&quot;
</code></pre><p>This creates a Backup object with the name <code>&lt;SCHEDULE NAME&gt;-&lt;TIMESTAMP&gt;</code>. The default backup retention period, expressed as TTL (time to live), is 30 days (720 hours); you can use the <code>--ttl &lt;DURATION&gt;</code> flag to change this as necessary. See 

    

<a href="/docs/master/how-velero-works/">how velero works</a> for more information about backup expiry.</p>
</li>
<li>
<p>A disaster happens and you need to recreate your resources.</p>
</li>
<li>
<p>Update your backup storage location to read-only mode (this prevents backup objects from being created or deleted in the backup storage location during the restore process):</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">kubectl patch backupstoragelocation &lt;STORAGE LOCATION NAME&gt; <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    --namespace velero <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    --type merge <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    --patch <span style="color:#e6db74">&#39;{&#34;spec&#34;:{&#34;accessMode&#34;:&#34;ReadOnly&#34;}}&#39;</span>
</code></pre></div></li>
<li>
<p>Create a restore with your most recent Velero Backup:</p>
<pre><code>velero restore create --from-backup &lt;SCHEDULE NAME&gt;-&lt;TIMESTAMP&gt;
</code></pre></li>
<li>
<p>When ready, revert your backup storage location to read-write mode:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">kubectl patch backupstoragelocation &lt;STORAGE LOCATION NAME&gt; <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>   --namespace velero <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>   --type merge <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>   --patch <span style="color:#e6db74">&#39;{&#34;spec&#34;:{&#34;accessMode&#34;:&#34;ReadWrite&#34;}}&#39;</span>
</code></pre></div></li>
</ol>

                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="section section-background-darkest-blue">
    <div class="section-content">
        <div class="row">
            <div class="col-xs-12 col-sm-6 col-lg-8">
                <h5>Getting Started</h5>
                <p>To help you get started, see the documentation.</p>
            </div>
            <div class="col-xs-12 col-sm-6 col-lg-3 offset-lg-1">
                <p><strong></strong></p>
                <a href="/docs"
                   class="btn btn-sm btn-primary btn-no-border">Documentation</a>
            </div>
        </div>
    </div>
</div>

<footer class="section site-footer">
    <div class="section-content">
        <div class="row justify-content-between align-items-center">
            <div class="col-12 col-md-8 mb-3 mb-md-0">
                <ul class="social-links text-center text-md-left">
                    
                        <li>
                            
                                <i class="fab fa-twitter fa-lg fa-fw mr-1"></i>
                            
                            <a href="https://twitter.com/projectvelero">Twitter</a>
                        </li>
                    
                        <li>
                            
                                <i class="fab fa-slack fa-lg fa-fw mr-1"></i>
                            
                            <a href="https://kubernetes.slack.com/messages/velero">Slack</a>
                        </li>
                    
                        <li>
                            
                                <i class="fas fa-users fa-lg fa-fw mr-1"></i>
                            
                            <a href="https://groups.google.com/forum/#!forum/projectvelero">Google Groups</a>
                        </li>
                    
                        <li>
                            
                                <i class="fa fa-rss fa-lg fa-fw mr-1"></i>
                            
                            <a href="feed.xml">RSS</a>
                        </li>
                    
                        <li>
                            
                                <i class="fab fa-github fa-lg fa-fw mr-1"></i>
                            
                            <a href="https://github.com/vmware-tanzu/velero">GitHub</a>
                        </li>
                    
                </ul>
            </div>
            <div class="col-12 col-md-4 text-center text-md-right">
                <a href="/" aria-label="Velero homepage"><img src="/img/Velero.svg" class="logo"
                                                              alt="Homepage"/></a>
            </div>
        </div>
        <div class="row align-items-center">
            <div class="col copyright text-center text-md-right mt-4">
                &copy; 2020 Velero Authors.
                <a href="http://vmware.github.io/" class="vm-logo">A VMware-backed project. <img
                            src="/img/vm-logo.png" alt="VMware logo"/></a>
            </div>
        </div>
    </div>
</footer>


<script defer src="https://use.fontawesome.com/releases/v5.8.1/js/all.js"
        integrity="sha384-g5uSoOSBd7KkhAMlnQILrecXvzst9TdC09/VM+pjDTCM+1il8RHz5fKANTFFb+gQ"
        crossorigin="anonymous"></script>
<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"
        integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
        crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"
        integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
        crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" crossorigin="anonymous"></script>

<script src="/js/jquery.matchHeight.js?1593121911"></script>
<script src="/js/scripts.js?1593121911"></script>

    </div>
</div>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script>
<script type="text/javascript"> docsearch({
        apiKey: '3d80f66bb5ecf85f8e2760caef383f24',
        indexName: 'velero',
        inputSelector: '.docsearch-input',
        algoliaOptions: {'facetFilters': ["version:master"]},
        debug: false 
    });
</script>
</body>

</html>
