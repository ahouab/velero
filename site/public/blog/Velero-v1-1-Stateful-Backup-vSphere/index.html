<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    
    
    <link rel="stylesheet" href="/styles.666a5dc1cd80e47092a71103358e46b56345de6f3044680f856f219cbc2fe91b.css" integrity="sha256-Zmpdwc2A5HCSpxEDNY5GtWNF3m8wRGgPhW8hnLwv6Rs=">
    <title>Velero Velero v1.1 backing up and restoring Stateful apps on vSphere</title>
    
</head>
<body id="blog">
<div class="container-fluid site-outer-container">
    <div class="site-container">
        <header class="site-header">
    <div class="site-header-content">
        <div class="logo">
            <a href="/" aria-label="Velero homepage"><img src="/img/Velero.svg" class="logo" alt="Homepage"/></a>
        </div>
        <ul class="nav-menu" id="header-nav">
            <li class="home"><a href="/" title="Velero">Home</a></li>
            <li class="docs"><a href="/docs/v1.4" title="Documentation">Documentation</a></li>
            <li class="plugins"><a href="/plugins" title="Plugins">Plugins</a></li>
            <li class="blog"><a href="/blog" title="Blog Posts">Blog</a></li>
            <li class="community"><a href="/community" title="Community">Community</a></li>
            <li class="resources"><a href="/resources" title="Resources">Resources</a></li>
        </ul>
        <div class="nav-mobile-link">
            <a href="javascript:void(0);" id="nav-mobile-toggle"></a>
        </div>
    </div>
</header>

        
    <div class="post-single-hero bg-color-med-blue">
        <div class="section">
            <div class="section-content">
                <h1>Velero v1.1 backing up and restoring Stateful apps on vSphere</h1>
            </div>
        </div>
    </div>
    <div class="post-single-body">
        <div class="section section-card">
            <div class="section-content pt-4 pb-0">
                <div class="post-single-meta">
                    <div class="post-single-meta-author">
                        
                            <div class="post-single-meta-author-avatar">
                                <img src="/img/contributors/cormac-pic.png" alt="Cormac Hogan">
                            </div>
                        

                        <div class="post-single-meta-author-name">
                            <a href="/tags/Cormac-Hogan">Cormac Hogan</a>
                        </div>
                    </div>

                    <div class="post-single-meta-date">
                        October 10, 2019
                    </div>
                </div>

                <div class="post-single-content">
                    <p>Velero version 1.1 provides support to backup applications orchestrated on upstream Kubernetes running natively on vSphere. This post will provide detailed information on how to use Velero v1.1 to backup and restore a stateful application (<code>Cassandra</code>) that is running in a Kubernetes cluster deployed on vSphere. At this time there is no vSphere plugin for snapshotting stateful applications during a Velero backup. In this case, we rely on a third party program called <code>restic</code> to copy the data contents from Persistent Volumes. The data is stored in the same S3 object store where the Kubernetes object metadata is stored.</p>
<h2 id="overview-of-steps">Overview of steps</h2>
<ul>
<li>Download and deploy Cassandra</li>
<li>Create and populate a database and table in Cassandra</li>
<li>Prepare Cassandra for a Velero backup by adding appropriate annotations</li>
<li>Use Velero to take a backup</li>
<li>Destroy the Cassandra deployment</li>
<li>Use Velero to restore the Cassandra application</li>
<li>Verify that the Cassandra database and table of contents have been restored</li>
</ul>
<h2 id="what-this-post-does-not-show">What this post does not show</h2>
<ul>
<li>This tutorial does not show how to deploy Velero v1.1 on vSphere. This is available in other tutorials.</li>
<li>For this backup to be successful, Velero needs to be installed with the <code>use-restic</code> flag. 

<a href="https://velero.io/docs/v1.1.0/restic/#Setup">More details on using Restic for stateful backups can be found in the docs here</a></li>
<li>The assumption is that the Kubernetes nodes in your cluster have internet access in order to pull the necessary Velero images. This guide does not show how to pull images using a local repository.</li>
</ul>
<h2 id="download-and-deploy-cassandra">Download and Deploy Cassandra</h2>
<p>For instructions on how to download and deploy a simple Cassandra StatefulSet, please refer to 

<a href="https://cormachogan.com/2019/06/12/kubernetes-storage-on-vsphere-101-statefulset/">this blog post</a>. This will show you how to deploy a Cassandra StatefulSet which we can use to do our Stateful aplication backup and restore. The manifests 

<a href="https://github.com/cormachogan/vsphere-storage-101/tree/master/StatefulSets">available here</a> use an earlier version of Cassandra (v11) that includes the <code>cqlsh</code> tool which we will use now to create a database and populate a table with some sample data.</p>
<p>If you follow the instructions above on how to deploy Cassandra on Kubernetes, you should see a similar response if you run the following command against your deployment:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"> kubectl exec -it cassandra-0 -n cassandra -- nodetool status
Datacenter: DC1-K8Demo
<span style="color:#f92672">======================</span>
Status<span style="color:#f92672">=</span>Up/Down
|/ State<span style="color:#f92672">=</span>Normal/Leaving/Joining/Moving
--  Address      Load       Tokens       Owns <span style="color:#f92672">(</span>effective<span style="color:#f92672">)</span>  Host ID                               Rack
UN  10.244.1.18  162.95 KiB  <span style="color:#ae81ff">32</span>           66.9%             2fc03eff-27ee-4934-b483-046e096ba116  Rack1-K8Demo
UN  10.244.1.19  174.32 KiB  <span style="color:#ae81ff">32</span>           61.4%             83867fd7-bb6f-45dd-b5ea-cdf5dcec9bad  Rack1-K8Demo
UN  10.244.2.14  161.04 KiB  <span style="color:#ae81ff">32</span>           71.7%             8d88d0ec-2981-4c8b-a295-b36eee62693c  Rack1-K8Demo
</code></pre></div><p>Now we will populate Cassandra with some data. Here we are connecting to the first Pod, cassandra-0 and running the <code>cqlsh</code> command which will allow us to create a Keyspace and a table.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ kubectl exec -it cassandra-0 -n cassandra -- cqlsh
Connected to K8Demo at 127.0.0.1:9042.
<span style="color:#f92672">[</span>cqlsh 5.0.1 | Cassandra 3.9 | CQL spec 3.4.2 | Native protocol v4<span style="color:#f92672">]</span>
Use HELP <span style="color:#66d9ef">for</span> help.

cqlsh&gt; CREATE KEYSPACE demodb WITH REPLICATION <span style="color:#f92672">=</span> <span style="color:#f92672">{</span> <span style="color:#e6db74">&#39;class&#39;</span> : <span style="color:#e6db74">&#39;SimpleStrategy&#39;</span>, <span style="color:#e6db74">&#39;replication_factor&#39;</span> : <span style="color:#ae81ff">3</span> <span style="color:#f92672">}</span>;

cqlsh&gt; use demodb;

cqlsh:demodb&gt; CREATE TABLE emp<span style="color:#f92672">(</span>emp_id int PRIMARY KEY, emp_name text, emp_city text, emp_sal varint,emp_phone varint<span style="color:#f92672">)</span>;

cqlsh:demodb&gt; INSERT INTO emp <span style="color:#f92672">(</span>emp_id, emp_name, emp_city, emp_phone, emp_sal<span style="color:#f92672">)</span> VALUES <span style="color:#f92672">(</span>100, <span style="color:#e6db74">&#39;Cormac&#39;</span>, <span style="color:#e6db74">&#39;Cork&#39;</span>, 999, 1000000<span style="color:#f92672">)</span>;

cqlsh:demodb&gt; <span style="color:#66d9ef">select</span> * from emp;

 emp_id | emp_city | emp_name | emp_phone | emp_sal
--------+----------+----------+-----------+---------
    <span style="color:#ae81ff">100</span> |     Cork |   Cormac |       <span style="color:#ae81ff">999</span> | <span style="color:#ae81ff">1000000</span>

<span style="color:#f92672">(</span><span style="color:#ae81ff">1</span> rows<span style="color:#f92672">)</span>
cqlsh:demodb&gt; exit
</code></pre></div><p>Now that we have populated the application with some data, let&rsquo;s annotate each of the Pods, back it up, destroy the application and then try to restore it using Velero v1.1.</p>
<h2 id="prepare-cassandra-for-a-velero-stateful-backup-by-adding-annotations">Prepare Cassandra for a Velero stateful backup by adding Annotations</h2>
<p>The first step is to add annotations to each of the Pods in the StatefulSet to indicate that the contents of the persistent volumes, mounted on cassandra-data, needs to be backed up as well. As mentioned previously, Velero uses the <code>restic</code> program at this time for capturing state/data from Kubernetes running on vSphere.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ kubectl -n cassandra describe pod/cassandra-0 | grep Annotations
Annotations:        &lt;none&gt;
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ kubectl -n cassandra annotate pod/cassandra-0 backup.velero.io/backup-volumes<span style="color:#f92672">=</span>cassandra-data
pod/cassandra-0 annotated
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ kubectl -n cassandra describe pod/cassandra-0 | grep Annotations
Annotations:        backup.velero.io/backup-volumes: cassandra-data
</code></pre></div><p>Repeat this action for the other Pods, in this example, Pods cassandra-1 and cassandra-2. This is an indication that we need to backup the persistent volume contents associated with each Pod.</p>
<h2 id="take-a-backup">Take a backup</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ velero backup create cassandra --include-namespaces cassandra
Backup request <span style="color:#e6db74">&#34;cassandra&#34;</span> submitted successfully.
Run <span style="color:#e6db74">`</span>velero backup describe cassandra<span style="color:#e6db74">`</span> or <span style="color:#e6db74">`</span>velero backup logs cassandra<span style="color:#e6db74">`</span> <span style="color:#66d9ef">for</span> more details.
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ velero backup describe cassandra
Name:         cassandra
Namespace:    velero
Labels:       velero.io/storage-location<span style="color:#f92672">=</span>default
Annotations:  &lt;none&gt;

Phase:  InProgress

Namespaces:
  Included:  cassandra
  Excluded:  &lt;none&gt;

Resources:
  Included:        *
  Excluded:        &lt;none&gt;
  Cluster-scoped:  auto

Label selector:  &lt;none&gt;

Storage Location:  default

Snapshot PVs:  auto

TTL:  720h0m0s

Hooks:  &lt;none&gt;

Backup Format Version:  <span style="color:#ae81ff">1</span>

Started:    2019-09-02 15:37:19 +0100 IST
Completed:  &lt;n/a&gt;

Expiration:  2019-10-02 15:37:19 +0100 IST

Persistent Volumes: &lt;none included&gt;

Restic Backups <span style="color:#f92672">(</span>specify --details <span style="color:#66d9ef">for</span> more information<span style="color:#f92672">)</span>:
  In Progress:  <span style="color:#ae81ff">1</span>
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ velero backup describe cassandra
Name:         cassandra
Namespace:    velero
Labels:       velero.io/storage-location<span style="color:#f92672">=</span>default
Annotations:  &lt;none&gt;

Phase:  Completed

Namespaces:
  Included:  cassandra
  Excluded:  &lt;none&gt;

Resources:
  Included:        *
  Excluded:        &lt;none&gt;
  Cluster-scoped:  auto

Label selector:  &lt;none&gt;

Storage Location:  default

Snapshot PVs:  auto

TTL:  720h0m0s

Hooks:  &lt;none&gt;

Backup Format Version:  <span style="color:#ae81ff">1</span>

Started:    2019-09-02 15:37:19 +0100 IST
Completed:  2019-09-02 15:37:34 +0100 IST

Expiration:  2019-10-02 15:37:19 +0100 IST

Persistent Volumes: &lt;none included&gt;

Restic Backups <span style="color:#f92672">(</span>specify --details <span style="color:#66d9ef">for</span> more information<span style="color:#f92672">)</span>:
  Completed:  <span style="color:#ae81ff">3</span>
</code></pre></div><p>If we include the option <code>--details</code> to the previous command, we can see the various objects that were backed up.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ velero backup describe cassandra --details
Name:         cassandra
Namespace:    velero
Labels:       velero.io/storage-location<span style="color:#f92672">=</span>default
Annotations:  &lt;none&gt;

Phase:  Completed

Namespaces:
  Included:  cassandra
  Excluded:  &lt;none&gt;

Resources:
  Included:        *
  Excluded:        &lt;none&gt;
  Cluster-scoped:  auto

Label selector:  &lt;none&gt;

Storage Location:  default

Snapshot PVs:  auto

TTL:  720h0m0s

Hooks:  &lt;none&gt;

Backup Format Version:  <span style="color:#ae81ff">1</span>

Started:    2019-09-02 15:37:19 +0100 IST
Completed:  2019-09-02 15:37:34 +0100 IST

Expiration:  2019-10-02 15:37:19 +0100 IST

Resource List:
  apps/v1/ControllerRevision:
    - cassandra/cassandra-55b978b564
  apps/v1/StatefulSet:
    - cassandra/cassandra
  v1/Endpoints:
    - cassandra/cassandra
  v1/Namespace:
    - cassandra
  v1/PersistentVolume:
    - pvc-2b574305-ca52-11e9-80e4-005056a239d9
    - pvc-51a681ad-ca52-11e9-80e4-005056a239d9
    - pvc-843241b7-ca52-11e9-80e4-005056a239d9
  v1/PersistentVolumeClaim:
    - cassandra/cassandra-data-cassandra-0
    - cassandra/cassandra-data-cassandra-1
    - cassandra/cassandra-data-cassandra-2
  v1/Pod:
    - cassandra/cassandra-0
    - cassandra/cassandra-1
    - cassandra/cassandra-2
  v1/Secret:
    - cassandra/default-token-bzh56
  v1/Service:
    - cassandra/cassandra
  v1/ServiceAccount:
    - cassandra/default

Persistent Volumes: &lt;none included&gt;

Restic Backups:
  Completed:
    cassandra/cassandra-0: cassandra-data
    cassandra/cassandra-1: cassandra-data
    cassandra/cassandra-2: cassandra-data
</code></pre></div><p>The command <code>velero backup logs</code> can be used to get additional information about the backup progress.</p>
<h2 id="destroy-the-cassandra-deployment">Destroy the Cassandra deployment</h2>
<p>Now that we have successfully taken a backup, which includes the <code>Restic</code> backups of the data, we will now go ahead and destroy the Cassandra namespace, and restore it once again.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ kubectl delete ns cassandra
namespace <span style="color:#e6db74">&#34;cassandra&#34;</span> deleted

$ kubectl get pv
No resources found.

$ kubectl get pods -n cassandra
No resources found.

$ kubestl get pvc -n cassandra
No resources found.
</code></pre></div><h2 id="restore-the-cassandra-application-via-velero">Restore the Cassandra application via Velero</h2>
<p>Now use Velero to restore the application and contents. The name of the backup must be specified at the command line using the <code>--from-backup</code> option. You can get the backup name from the following command:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ velero backup get
NAME                 STATUS      CREATED                         EXPIRES   STORAGE LOCATION   SELECTOR
cassandra1            Completed   2019-10-02 15:37:34 +0100 IST   31d       default            &lt;none&gt;
</code></pre></div><p>Next, initiate the restore:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ velero restore create cassandra1 --from-backup cassandra1
Restore request <span style="color:#e6db74">&#34;cassandra1&#34;</span> submitted successfully.
Run <span style="color:#e6db74">`</span>velero restore describe cassandra1<span style="color:#e6db74">`</span> or <span style="color:#e6db74">`</span>velero restore logs cassandra1<span style="color:#e6db74">`</span> <span style="color:#66d9ef">for</span> more details.
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ velero restore describe cassandra1
Name:         cassandra1
Namespace:    velero
Labels:       &lt;none&gt;
Annotations:  &lt;none&gt;

Phase:  InProgress

Backup:  cassandra1

Namespaces:
  Included:  *
  Excluded:  &lt;none&gt;

Resources:
  Included:        *
  Excluded:        nodes, events, events.events.k8s.io, backups.velero.io, restores.velero.io, resticrepositories.velero.io
  Cluster-scoped:  auto

Namespace mappings:  &lt;none&gt;

Label selector:  &lt;none&gt;

Restore PVs:  auto

Restic Restores <span style="color:#f92672">(</span>specify --details <span style="color:#66d9ef">for</span> more information<span style="color:#f92672">)</span>:
  New:  <span style="color:#ae81ff">3</span>
</code></pre></div><p>Let&rsquo;s get some further information by adding the <code>--details</code> option.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ velero restore describe cassandra1 --details
Name:         cassandra1
Namespace:    velero
Labels:       &lt;none&gt;
Annotations:  &lt;none&gt;

Phase:  InProgress

Backup:  cassandra1

Namespaces:
  Included:  *
  Excluded:  &lt;none&gt;

Resources:
  Included:        *
  Excluded:        nodes, events, events.events.k8s.io, backups.velero.io, restores.velero.io, resticrepositories.velero.io
  Cluster-scoped:  auto

Namespace mappings:  &lt;none&gt;

Label selector:  &lt;none&gt;

Restore PVs:  auto

Restic Restores:
  New:
    cassandra/cassandra-0: cassandra-data
    cassandra/cassandra-1: cassandra-data
    cassandra/cassandra-2: cassandra-data
</code></pre></div><p>When the restore completes, the <code>Phase</code> and <code>Restic Restores</code> should change to <code>Completed</code> as shown below.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ velero restore describe cassandra1 --details
Name:         cassandra1
Namespace:    velero
Labels:       &lt;none&gt;
Annotations:  &lt;none&gt;

Phase:  Completed

Backup:  cassandra1

Namespaces:
  Included:  *
  Excluded:  &lt;none&gt;

Resources:
  Included:        *
  Excluded:        nodes, events, events.events.k8s.io, backups.velero.io, restores.velero.io, resticrepositories.velero.io
  Cluster-scoped:  auto

Namespace mappings:  &lt;none&gt;

Label selector:  &lt;none&gt;

Restore PVs:  auto

Restic Restores:
  Completed:
    cassandra/cassandra-0: cassandra-data
    cassandra/cassandra-1: cassandra-data
    cassandra/cassandra-2: cassandra-data
</code></pre></div><p>The <code>velero restore logs</code> command can also be used to track restore progress.</p>
<h2 id="validate-the-restored-application">Validate the restored application</h2>
<p>Use some commands seen earlier to validate that not only is the application restored, but also the data.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ kubectl get ns
NAME                  STATUS   AGE
cassandra             Active   2m35s
default               Active   13d
kube-node-lease       Active   13d
kube-public           Active   13d
kube-system           Active   13d
velero                Active   35m
wavefront-collector   Active   7d5h
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ kubectl get pv
NAME                                       CAPACITY   ACCESS MODES   RECLAIM POLICY   STATUS   CLAIM                                  STORAGECLASS   REASON   AGE
pvc-51ae99a9-cd91-11e9-80e4-005056a239d9   1Gi        RWO            Delete           Bound    cassandra/cassandra-data-cassandra-0   cass-sc-csi             2m28s
pvc-51b15558-cd91-11e9-80e4-005056a239d9   1Gi        RWO            Delete           Bound    cassandra/cassandra-data-cassandra-1   cass-sc-csi             2m22s
pvc-51b4079c-cd91-11e9-80e4-005056a239d9   1Gi        RWO            Delete           Bound    cassandra/cassandra-data-cassandra-2   cass-sc-csi             2m27s
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ kubectl get pvc -n cassandra
NAME                         STATUS   VOLUME                                     CAPACITY   ACCESS MODES   STORAGECLASS   AGE
cassandra-data-cassandra-0   Bound    pvc-51ae99a9-cd91-11e9-80e4-005056a239d9   1Gi        RWO            cass-sc-csi    2m49s
cassandra-data-cassandra-1   Bound    pvc-51b15558-cd91-11e9-80e4-005056a239d9   1Gi        RWO            cass-sc-csi    2m49s
cassandra-data-cassandra-2   Bound    pvc-51b4079c-cd91-11e9-80e4-005056a239d9   1Gi        RWO            cass-sc-csi    2m49s
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ kubectl exec -it cassandra-0 -n cassandra -- nodetool status
Datacenter: DC1-K8Demo
<span style="color:#f92672">======================</span>
Status<span style="color:#f92672">=</span>Up/Down
|/ State<span style="color:#f92672">=</span>Normal/Leaving/Joining/Moving
--  Address      Load       Tokens       Owns <span style="color:#f92672">(</span>effective<span style="color:#f92672">)</span>  Host ID                               Rack
UN  10.244.1.21  138.53 KiB  <span style="color:#ae81ff">32</span>           66.9%             2fc03eff-27ee-4934-b483-046e096ba116  Rack1-K8Demo
UN  10.244.1.22  166.45 KiB  <span style="color:#ae81ff">32</span>           71.7%             8d88d0ec-2981-4c8b-a295-b36eee62693c  Rack1-K8Demo
UN  10.244.2.23  160.43 KiB  <span style="color:#ae81ff">32</span>           61.4%             83867fd7-bb6f-45dd-b5ea-cdf5dcec9bad  Rack1-K8Demo
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ kubectl exec -it cassandra-0 -n cassandra -- cqlsh
Connected to K8Demo at 127.0.0.1:9042.
<span style="color:#f92672">[</span>cqlsh 5.0.1 | Cassandra 3.9 | CQL spec 3.4.2 | Native protocol v4<span style="color:#f92672">]</span>
Use HELP <span style="color:#66d9ef">for</span> help.
cqlsh&gt; use demodb;

cqlsh:demodb&gt; <span style="color:#66d9ef">select</span> * from emp;

 emp_id | emp_city | emp_name | emp_phone | emp_sal
--------+----------+----------+-----------+---------
    <span style="color:#ae81ff">100</span> |     Cork |   Cormac |       <span style="color:#ae81ff">999</span> | <span style="color:#ae81ff">1000000</span>

<span style="color:#f92672">(</span><span style="color:#ae81ff">1</span> rows<span style="color:#f92672">)</span>
cqlsh:demodb&gt;
</code></pre></div><p>It looks like the restore has been successful. Velero v1.1 has successfully restored the Kubenetes objects for the Cassandra application, as well as restored the database and table contents.</p>
<h2 id="feedback-and-participation">Feedback and Participation</h2>
<p>As always, we welcome feedback and participation in the development of Velero. 

<a href="https://velero.io/community/">All information on how to contact us or become active can be found here</a></p>
<p>You can find us on 

<a href="https://kubernetes.slack.com/messages/C6VCGP4MT">Kubernetes Slack in the #velero channel</a>, and follow us on Twitter at 

<a href="https://twitter.com/projectvelero">@projectvelero</a>.</p>

                </div>
            </div>
        </div>
    </div>

    <div class="section pt-3">
        <div class="section-content section-content-thin">
            <h5 class="font-color-darker">Related Content</h5>
<div class="row">
    
        <div class="col-xs col-md-4">
    <div class="card card-light mb-3 mb-md-0 blog-card">
        <div class="card-body match-height">
            <div class="post-thumbnail">
                
                    <img src="/img/posts/vsphere-logo.jpg" alt="Velero v1.1 backing up and restoring apps on vSphere" />
                
            </div>
            <article class="post">
                <h5 class="text-center font-weight-medium">
                    <a href="/blog/Velero-v1-1-on-vSphere/" class="post-title">Velero v1.1 backing up and restoring apps on vSphere</a>
                </h5>
                <div class="post-entry">
                    A How-To guide to run Velero on vSphere.
                </div>
            </article>
        </div>
    </div>
</div>
    
</div>
        </div>
    </div>

        <div class="section section-background-darkest-blue">
    <div class="section-content">
        <div class="row">
            <div class="col-xs-12 col-sm-6 col-lg-8">
                <h5>Getting Started</h5>
                <p>To help you get started, see the documentation.</p>
            </div>
            <div class="col-xs-12 col-sm-6 col-lg-3 offset-lg-1">
                <p><strong></strong></p>
                <a href="/docs"
                   class="btn btn-sm btn-primary btn-no-border">Documentation</a>
            </div>
        </div>
    </div>
</div>

<footer class="section site-footer">
    <div class="section-content">
        <div class="row justify-content-between align-items-center">
            <div class="col-12 col-md-8 mb-3 mb-md-0">
                <ul class="social-links text-center text-md-left">
                    
                        <li>
                            
                                <i class="fab fa-twitter fa-lg fa-fw mr-1"></i>
                            
                            <a href="https://twitter.com/projectvelero">Twitter</a>
                        </li>
                    
                        <li>
                            
                                <i class="fab fa-slack fa-lg fa-fw mr-1"></i>
                            
                            <a href="https://kubernetes.slack.com/messages/velero">Slack</a>
                        </li>
                    
                        <li>
                            
                                <i class="fas fa-users fa-lg fa-fw mr-1"></i>
                            
                            <a href="https://groups.google.com/forum/#!forum/projectvelero">Google Groups</a>
                        </li>
                    
                        <li>
                            
                                <i class="fa fa-rss fa-lg fa-fw mr-1"></i>
                            
                            <a href="feed.xml">RSS</a>
                        </li>
                    
                        <li>
                            
                                <i class="fab fa-github fa-lg fa-fw mr-1"></i>
                            
                            <a href="https://github.com/vmware-tanzu/velero">GitHub</a>
                        </li>
                    
                </ul>
            </div>
            <div class="col-12 col-md-4 text-center text-md-right">
                <a href="/" aria-label="Velero homepage"><img src="/img/Velero.svg" class="logo"
                                                              alt="Homepage"/></a>
            </div>
        </div>
        <div class="row align-items-center">
            <div class="col copyright text-center text-md-right mt-4">
                &copy; 2020 Velero Authors.
                <a href="http://vmware.github.io/" class="vm-logo">A VMware-backed project. <img
                            src="/img/vm-logo.png" alt="VMware logo"/></a>
            </div>
        </div>
    </div>
</footer>


<script defer src="https://use.fontawesome.com/releases/v5.8.1/js/all.js"
        integrity="sha384-g5uSoOSBd7KkhAMlnQILrecXvzst9TdC09/VM+pjDTCM+1il8RHz5fKANTFFb+gQ"
        crossorigin="anonymous"></script>
<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"
        integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
        crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"
        integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
        crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" crossorigin="anonymous"></script>

<script src="/js/jquery.matchHeight.js?1593121911"></script>
<script src="/js/scripts.js?1593121911"></script>

    </div>
</div>
</body>
</html>