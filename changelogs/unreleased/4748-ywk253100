Refactor schedule controller with kubebuilder